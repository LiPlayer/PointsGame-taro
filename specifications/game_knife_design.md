# 神厨飞刀 (Chef's Flying Knife) 1:1 完美还原设计规范 (V1.4)

**目标**: 1:1 像素级还原 Ketchapp 名作 "Knife Hit"，适配“神厨”主题。游戏强调**连续性与破坏感**，彻底剥离离散的“关卡”概念，代之以无缝流转的挑战圆盘。

---

## 1. 核心玩法：循环与破坏 (The Core Loop)

游戏不存在手动选关或关卡加载。挑战是连续的，唯一的停顿是玩家失败后的复活或重开。

### 1.1 基础交互流程
1.  **就绪 (Ready)**：一把飞刀插在底部中央的槽位中，处于选中状态。
2.  **投掷 (Throw)**：玩家 Tap 屏幕任何位置，当前飞刀沿直线轨迹快速向上弹出。
3.  **命中判定 (Resolve)**：
    -   **插中 (Stick)**：刀尖进入圆盘边界且未触碰已有的刀具。触发 Recoil 震动，分数 +1，弹药库计数减一。
    -   **碰撞 (Clash)**：刀柄或刀身触碰已插在圆盘上的物体。游戏立即结束，进入结算界面。
4.  **圆盘更迭 (Phase Transition)**：
    -   每一“轮”需要投掷固定数量的飞刀（通常为 6-12 把）。
    -   当最后一把刀命中，圆盘产生物理级“碎裂”爆炸效果，屏幕短暂白闪。
    -   在爆炸碎片飞散的同时，下一个目标圆盘（通过主题库随机选取）从深处淡入/缩放出现，游戏无感衔接，分数累加。

### 1.2 无尽变幻：程序化旋转脚本
难度不挂钩于“关卡编号”，而是动态调节的旋转复杂度：
-   **行为池 (Behavior Pool)**:
    -   `Constant`: 持续匀速（三档：慢、中、极快）。
    -   `Oscillate`: 钟摆式往复（幅度 30°-180° 不等）。
    -   `Jerk`: 突然的变速。例如转动中突然停顿 0.2s 或突然反转，极具欺骗性。
    -   `SmoothLerp`: 速度的线性/平滑过渡，产生惯性滑行感。
-   **生成逻辑**: 系统根据当前分数 $S$ 决定切换频率。
    -   $S < 20$: 主要是 `Constant` 和 `SmoothLerp`。
    -   $S > 50$: 频繁出现 `Jerk` 和 `Reverse`。

---

## 2. 物理与视觉逻辑 (Physics & Rendering)

### 2.1 飞刀动力学 (Knife Physics)
-   **发射速度**: 飞刀以约 $15m/s$ 的速度上升，不受重力影响，轨迹为绝对垂直直线。
-   **插入表现**: 命中后，刀尖深度固定插入圆盘边缘。刀具随圆盘切线角速度同步运动。
-   **失败反馈**: 发生碰撞时，开启重力模拟（Gravity: 20），飞刀带随机角速度向斜下方翻转坠落，场景背景色瞬间加深或变色以示警告。

### 2.2 破碎美学 (Shatter Vibe)
-   **破坏快感**：命中最后一刀时的圆盘碎裂是多巴胺高点。碎片应为 4-8 块不规则的多边形（低多边形风格），基于爆炸中心点向外溅射，轨迹受重力影响掉落。
-   **背景演进**: 每当圆盘破碎，系统从主题库随机抽取下一个背景。背景与地板的色相 (Hue) 会产生平滑漂移，营造“时空流转”的错觉。

---

## 3. 视觉规范 (Visual Specifications - Minimalist Flat Style)

严格遵循 **极简扁平矢量风 (Minimalist Flat Vector)**。

### 3.1 核心风格
-   **无写实光影**: 强制使用 `MeshBasicMaterial`。去除高光、点光源、环境遮蔽，确保 1:1 的干净质感。
-   **矢量线条**: 圆盘必须带有 2-3 层深色的内嵌同心圆线条，模拟木头的年轮或砧板的圆弧感，维持矢量美感。
-   **色彩方案 (Earth Tones)**:
    -   **背景**: 典型色色 `#D2A679`。
    -   **圆盘**: 经典色色 `#8B5A2B`。
    -   **UI**: 纯白，高对比度。

### 3.2 UI 元素布局 (1:1 还原)
-   **主分数**: 屏幕中央、圆盘之后，使用超大字号（透明度约 30% 或白色轮廓）。
-   **弹药库**: 位于左下角，垂直排列的红色飞刀图标。
    -   可用 (Inventory)：清晰的扁平红色图标。
    -   已消耗 (Depleted)：半透明黑色占位符。

---

## 4. 主题库预设 (Theme Skins)

虽然没有关卡，但视觉上会随圆盘更迭在以下主题间无缝切换：

| 索引 | 主题名称 | 目标圆盘 (Log) | 特征纹理 | 投掷飞刀 (Knife) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | **经典橡木** | 木质圆盘 | 环形年轮 | 传统牛耳尖刀 |
| 2 | **生机果园** | 西瓜/南瓜平面 | 放射状果肉 | 极简餐刀 |
| 3 | **生铁工房** | 金属齿轮 | 铆钉圆圈 | 钢制钢钉 |
| 4 | **深夜食堂** | 圆形砧板 | 切痕交叉线 | 宽刃厨刀 |

---

## 5. 技术约束 (Technical Redline)

-   **旋转一致性**：必须支持逻辑时间步长，确保不同性能设备下的挑战难度一致。
-   **合批优化**: 场景中大量插在木头上的飞刀应视为圆盘子物体，利用 Three.js 的 `Group` 统一变换。
-   **物理引擎**: `cannon-es` 仅在“失败坠落”和“圆盘炸裂”时介入，常规飞行使用简化数学公式提升性能。
