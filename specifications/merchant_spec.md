# 门店积分小游戏 · 商户端 (Merchant Terminal) 开发规范

## 1. 核心定位 (Core Positioning)
商户端（B端）是老板的“极简营销遥控器”。
- **目标：** 0 硬件门槛，手机即后台。
- **核心功能：** 聚合支付、实时对账、营销活动下发、全民星探管理。

---

## 2. 视觉与交互规范 (UI/UX)
商户端应与 C 端（变色龙系统）在视觉上有所区分，强调**高效、冷静、专业**感。

- **配色方案：**
    - 主色：`Slate-900` (专业黑)
    - 强调色：`Indigo-600` (科技蓝/极客感)
    - 预警色：`Rose-500`
- **主要布局：**
    - 底部导航：首页（数据综述）、收款（收钱码）、营销（任务中心）、我的（店铺设置/合伙人）。
    - 语音播报：必须支持后台常驻播报（需适配微信小程序语音插件）。

---

## 3. 功能模块详情 (Modules)

### 3.1 聚合收款 (Aggregate Payment)
- **双码合一：** 提供统一收款码，用户扫码后系统自动识别环境并调用对应接口。
- **合并播报：** 针对高频小额场景，支持“3秒内连续入账合并播报”。
- **实时流水：** 列表展示每一笔订单，标明积分抵扣额、实付金额、分账状态。

### 3.2 悬赏任务中心 (Task Center)
- **任务模板：**
    - *雨天到店奖励*：系统检测到当地降雨，提醒老板一键下发双倍积分任务。
    - *邀请好友领券*：通过积分激励用户裂变。
- **数据回馈：** 每个任务包展示转化率、投入产出比。

### 3.3 全民星探管理 (Partner Management)
- **星探列表：** 查看所有推荐该店的星探（骑手、老主顾等）。
- **佣金比例设置：** 老板可自定义给星探的流水分润比例（基于平台规则范围）。

### 3.4 数据报表 (Analytics)
- **ECharts 集成：** 展示 GMV 走势图、新老客户比例、积分池存量。
- **资产化报表：** 展示由于“积分钱包容量”带来的潜在回头客价值。

---

## 4. 技术架构要求 (Technical Architecture)

- **前端：** Taro (React + TS)
- **数据可视化：** `echarts-for-weixin` 或轻量级 Canvas 方案。
- **通信：** WebSocket 或云开发监听集合变更，确保流水实时刷新。
- **资金合规：** **绝对严禁**商家端出现自建资金池。必须调用官方分账接口（微信分账/支付宝直付通）。

---

## 5. 项目结构 (Project Organization)
为了后续维护，工程将进行如下组织调整：
- `src/pages/merchant/...`：商户端专属页面。
- `src/components/merchant/...`：商户端专属组件。
- `src/utils/merchant/...`：商户端专属逻辑（如语音合成、分账计算）。

---

## 6. 合规红线 (Compliance Redline)
- 禁止保存用户支付密码。
- 禁止在小程序内直接展示银行卡完整账号。
- 必须通过地理围栏（LBS）校验任务发布的真实性。
